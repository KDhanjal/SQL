/* https://www.hackerrank.com/challenges/15-days-of-learning-sql/problem */

SELECT 
    C.company_code,
    C.founder,
    LM.lead_count,
    SM.senior_count,
    M.manager_count,
    E.employee_count
FROM Company C

LEFT JOIN (
    SELECT company_code, COUNT(DISTINCT lead_manager_code) AS lead_count
    FROM Lead_Manager
    GROUP BY company_code
) LM ON C.company_code = LM.company_code

LEFT JOIN (
    SELECT company_code, COUNT(DISTINCT senior_manager_code) AS senior_count
    FROM Senior_Manager
    GROUP BY company_code
) SM ON C.company_code = SM.company_code

LEFT JOIN (
    SELECT company_code, COUNT(DISTINCT manager_code) AS manager_count
    FROM Manager
    GROUP BY company_code
) M ON C.company_code = M.company_code

LEFT JOIN (
    SELECT company_code, COUNT(DISTINCT employee_code) AS employee_count
    FROM Employee
    GROUP BY company_code
) E ON C.company_code = E.company_code

ORDER BY C.company_code;
